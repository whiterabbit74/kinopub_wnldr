<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–≥—Ä—É–∑—á–∏–∫ M3U8</title>
    <link rel="stylesheet" href="styles/app.css">

</head>
<body>
    <div class="app-shell">
        <header>
            <h1>M3U8 –ó–∞–≥—Ä—É–∑—á–∏–∫</h1>
            <button class="theme-toggle" id="themeToggle" type="button" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                <span id="themeIcon">üåô</span>
                <span id="themeText">–¢—ë–º–Ω–∞—è</span>
            </button>
        </header>

        <!-- Back button -->
        <button class="btn btn-secondary hidden" id="backBtn" type="button">‚Üê –ù–∞–∑–∞–¥</button>

        <main>
            <!-- –ë–ª–æ–∫ 1: –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ -->
            <section class="card step" id="file-selection">
                <h2>–§–∞–π–ª –ø–ª–µ–π–ª–∏—Å—Ç–∞</h2>
                <div class="drop-zone" id="dropZone">
                    <div class="drop-icon">üìÇ</div>
                    <div class="drop-title">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ M3U8 —Ñ–∞–π–ª</div>
                    <div class="drop-subtitle">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
                    <input type="file" id="fileInput" class="file-input" accept=".m3u8">
                </div>
                <div class="error-message hidden" id="errorMessage"></div>
            </section>

            <!-- –ë–ª–æ–∫ 2: –í—ã–±–æ—Ä –¥–æ—Ä–æ–∂–µ–∫ -->
            <section class="card step" id="track-selection" hidden>
                <h2>–í—ã–±–æ—Ä –¥–æ—Ä–æ–∂–µ–∫</h2>
                <p class="subtitle">–£–∫–∞–∂–∏—Ç–µ –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ –¥–æ—Ä–æ–∂–∫–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</p>
                <div class="tracks-grid">
                    <div>
                        <h3>–í–∏–¥–µ–æ</h3>
                        <div class="track-list" id="videoTracks"></div>
                    </div>
                    <div>
                        <h3>–ê—É–¥–∏–æ</h3>
                        <div class="track-list" id="audioTracks"></div>
                    </div>
                </div>
                <button class="btn btn-primary" id="nextBtn" type="button" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            </section>

            <!-- –ë–ª–æ–∫ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è -->
            <section class="card step" id="download-settings" hidden>
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <div class="form-grid">
                    <div class="form-field">
                        <label for="threadRange">–ü–æ—Ç–æ–∫–∏: <span id="threadValue">4</span></label>
                        <input type="range" id="threadRange" min="1" max="16" value="4" step="1">
                        <div class="range-labels">
                            <span>1</span>
                            <span>16</span>
                        </div>
                    </div>
                    <div class="form-field">
                        <label for="filename">–ò–º—è —Ñ–∞–π–ª–∞</label>
                        <input type="text" id="filename" placeholder="–ò–º—è –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è">
                    </div>
                    <div class="form-field">
                        <label for="downloadPath">–ü–∞–ø–∫–∞</label>
                        <div class="path-display" id="downloadPath" role="button" tabindex="0">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è‚Ä¶</div>
                        <button class="btn btn-secondary" id="selectFolderBtn" type="button">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>
                <div class="error-message hidden" id="downloadError"></div>
                <button class="btn btn-primary" id="downloadBtn" type="button" disabled>–°–∫–∞—á–∞—Ç—å</button>

                <div class="progress-container" id="progressContainer">
                    <div class="progress-stages" id="progressStages">
                        <div class="stage" data-stage="video">üìπ –í–∏–¥–µ–æ</div>
                        <div class="stage" data-stage="audio">üéµ –ê—É–¥–∏–æ</div>
                        <div class="stage" data-stage="merge">‚ú® –°–∫–ª–µ–π–∫–∞</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progressStatus">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞‚Ä¶</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="log-container" id="logContainer">
                        <div class="log-header">
                            <span>–õ–æ–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞</span>
                            <button class="log-toggle" id="logToggle" type="button">‚Üì</button>
                        </div>
                        <div class="log-content" id="logContent"></div>
                    </div>
                </div>

                <div class="success-message" id="successSection">
                    ‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω
                    <div class="success-actions">
                        <button class="btn btn-secondary" id="showFileBtn" type="button">–ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="renderer.js"></script>
</body>
</html>
